---
title: 寻找环的起点
author: admin
layout: post
categories:
  - Mathematics
---

最近研究些问题，发现计算机的所有问题究其本质都是数学问题，任何复杂的外表如操作系统，网络等等只不过是披了一层外衣罢了，甚至可以说现如今数学发展的水平直接决定着其他各个学科的发展水平。

废话不多说了，来道小学数学题

> Given a circular linked list, implement an algorithm which returns node at the beginning of the loop.  
> DEFINITION  
> Circular linked list: A (corrupt) linked list in which a node’s next pointer points to an earlier node, so as to make a loop in the linked list.  
> EXAMPLE  
> Input: A -> B -> C -> D -> E -> C [the same C as earlier]  
> Output: C



翻译一下就是求环的起点。这种环的常见题型就是检查一个链表是否存在环，我们常常使用一个快指针和一个慢指针一起从头开始跑，如果存在环的话，两指针就一定相遇，简单而明了。那么如果让你判断从哪里开始环呢？看起来就不那么简单了，OK，关门，放小学数学！

![3](/assets/images/2012/9/1-2.png)

如图我们设起点到环的起点A的距离为m，两个指针第一次相遇点于B，与A点的距离是k，整个环的长度是c，同时我们使用一个慢指针一次走一步，一个快指针一次走两步。那么他们第一次相遇时，慢指针经过的路程是：m+k+a\*c ，快指针经过的路程是：m+k+b\*c，a和b是两个指针相遇前经过的圈数。那么根据小学体育老师教给我们的知识，快指针速度是慢指针两倍，经过相同时间，快指针经过的路程也应该是慢指针的两倍。即：

> 2(m+k+a\*c)=m+k+b\*c
> 
> m+k=c\*(b-2a)

其中b-2a是整数，我们可以将公式写成

> m+k=n \* c

那么我们该怎么使用这个公式来求出环的起点呢？

指针现在在B点，再移动c-k步就可以回到起点了，可是关键是我们怎么知道c-k是多少呢，观察上面的式子可以推导到

> m=(n-1)\*c+c-k

这个m可以作为我们的计时器，当行走m距离时，就就相当于行走一个c-k或者是多几圈，不管如何，当行走了m距离后，指针一定能够回到环的开头，即A点。

所以我们的解决方法就是，当快慢指针第一次相遇后，把其中一个指针放到最开头的起点，另一个指针不变，他们同时以相同的步长移动，那么相遇点一定是环的开头。因为一个指针走了m时，另一个一定走了c-k。

看这个坑爹的计算机题目和计算机到底有没有一毛钱的关系。类似这个题目还有常见的一个题目，就是对于一个单链表，如何找出最后第k个节点。求解的思路也可以参考于此。如何找出最后第k个节点，那么就是从头走s-k步，那么我怎么知道s-k步是多少呢，可以先让一个指针从头走k步，这时加入第二个指针，两者开始一起遍历，那么当第一个指针到达末尾的，就可以充当一个定时器的作用，来记录走了s-k步，这是第二个指针也就是从头走了s-k步，所以也就是最后第k个节点。
